(function(e){function t(t){for(var a,s,o=t[0],c=t[1],u=t[2],h=0,f=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},i={app:0},r=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/DigiGranular/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e623"),n("e379"),n("5dc8"),n("37e1");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container",attrs:{id:"app"}},[n("div",{attrs:{id:"presets"}},[e._l(e.sounds,(function(t,a){return n("div",{key:a,staticClass:"preset btn",class:{active:a===e.soundActiveIdx},on:{click:function(t){e.soundActiveIdx=a}}},[n("div",[e._v(e._s(a+1))])])})),n("div",{staticClass:"preset stop btn",on:{click:e.stop}},[n("i",{staticClass:"fa fa-stop"})])],2),n("div",{attrs:{id:"waveform-wrapper"}},[n("div",{attrs:{id:"waveform"}}),n("canvas",{ref:"canvas",attrs:{id:"canvas"},on:{click:e.click}})]),n("div",{staticClass:"my-3 row",attrs:{id:"controls"}},e._l(e.params,(function(t){return n("div",{key:t.label,staticClass:"control col-6 col-md-4 px-2 px-md-4 mb-3"},[n("label",{staticClass:"mb-0",attrs:{for:"range"}},[e._v(" "+e._s(t.label)+" ")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.value,expression:"param.value",modifiers:{number:!0}}],staticClass:"slider",attrs:{id:"range",type:"range",min:t.min,max:t.max,step:t.step},domProps:{value:t.value},on:{dblclick:function(e){t.value=t.default},__r:function(n){e.$set(t,"value",e._n(n.target.value))},blur:function(t){return e.$forceUpdate()}}})])})),0)])},r=[],s=(n("cb29"),n("4160"),n("d81d"),n("159b"),n("b9b7")),o=n.n(s),c=(n("a434"),n("d4ec")),u=n("bee2"),l=function(){function e(){Object(c["a"])(this,e)}return Object(u["a"])(e,null,[{key:"map",value:function(e,t,n,a,i){return(e-t)/(n-t)*(i-a)+a}},{key:"clamp",value:function(e,t,n){return Math.min(n,Math.max(t,e))}},{key:"randomFloat",value:function(e,t){return Math.random()*(t-e)+e}},{key:"swap",value:function(e,t,n){return 1===e.length||e.splice(n,1,e.splice(t,1,e[n])[0]),e}},{key:"modulo",value:function(e,t){return(e%t+t)%t}}]),e}(),h={data:function(){return{useEnvelope:!0,params:{grainSize:{min:.01,max:1,step:.01,default:.1,value:.1,label:"Grain Size",tooltip:"How big the grain? (10ms-200ms)"},pitchShift:{min:0,max:2,step:.01,default:1,value:1,label:"Pitch Shift",tooltip:"Change playbackRate of grain"},pan:{min:0,max:1,step:.01,default:.5,value:.5,label:"Pan",tooltip:"Pan much or not really?"},overlap:{min:0,max:1,step:.01,default:0,value:0,label:"Overlap"},randomness:{min:0,max:1,step:.01,default:.5,value:.5,label:"Randomness",tooltip:"How far from original point?"},reverse:{min:0,max:1,step:.01,default:.5,value:.5,label:"Reverse",tooltip:"Probability of reading buffer in reverse"}},envelope:{attack:.002,release:.002},sounds:["sounds/speech.wav","sounds/bird.wav","sounds/guitar.wav","sounds/bonang.wav"],soundActiveIdx:0,dragging:!1,buffers:[],reverseBuffers:[],ctx:null,canvasCtx:null,canvas:null,grains:[],master:null,width:null,origin:{x:null,y:null}}},computed:{grainSize:function(){return this.params.grainSize.value},pitchShift:function(){return this.params.pitchShift.value},pan:function(){return this.params.pan.value},overlap:function(){return this.params.overlap.value},randomness:function(){return this.params.randomness.value},reverse:function(){return this.params.reverse.value},x:function(){return this.origin&&this.origin.x?this.width*this.origin.x:null},isPlaying:function(){return null!==this.origin}},watch:{soundActiveIdx:function(){this.changeSound(this.soundActiveIdx)},origin:function(){this.updateInterval()},grainSize:function(){this.updateInterval()},overlap:function(){this.updateInterval()}},created:function(){var e=this;this.params.reverse.value=0,this.params.randomness.value=0,this.params.pan.value=0,document.addEventListener("keypress",(function(t){switch(t.key){case"1":case"2":case"3":case"4":e.soundActiveIdx=t.key-1;break;case" ":e.stop();break;default:break}}));var t=window.AudioContext||window.webkitAudioContext;this.ctx=new t,window.ctx=this.ctx,this.loadBuffers()},mounted:function(){var e=this;this.initWave(),this.initCanvas(),window.addEventListener("resize",(function(){e.resize()})),this.master=this.ctx.createGain(),this.master.connect(this.ctx.destination),setTimeout((function(){e.resize()}),200)},methods:{loadBuffers:function(){var e=this;this.sounds.forEach((function(t,n){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){var t=a.response;e.ctx.decodeAudioData(t,(function(t){e.buffers[n]=t,0===n&&e.changeSound(0);for(var a=e.ctx.createBuffer(1,t.length,t.sampleRate),i=a.getChannelData(0),r=0;r<t.length;r++)i[r]=t.getChannelData(0)[r];Array.prototype.reverse.call(a.getChannelData(0)),e.reverseBuffers[n]=a}),(function(e){console.error("Error with decoding audio data",e.err)}))},a.send()}))},changeSound:function(e){this.wave.loadDecodedBuffer(this.buffers[e])},resize:function(){this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this.wave.setHeight(this.height)},initCanvas:function(){this.canvas=this.$refs.canvas,this.canvasCtx=this.canvas.getContext("2d"),this.resize()},initWave:function(){this.wave=o.a.create({container:"#waveform",waveColor:"#ff8000",progressColor:"transparent",barHeight:1,barWidth:1,fillParent:!0,cursorWidth:0,audioContext:this.ctx}),window.wave=this.wave},click:function(e){var t=e.offsetX,n=e.offsetY,a=t/this.width,i=n/this.height;this.origin={x:a,y:i},this.ctx.resume()},stop:function(){this.origin=null,this.clearCanvas(),window.clearInterval(this.interval)},addGrain:function(){var e=this;this.buffer=Math.random()<=this.reverse?this.reverseBuffers[this.soundActiveIdx]:this.buffers[this.soundActiveIdx];var t=l.map(this.x,0,this.width,0,this.buffer.duration),n=this.randomness*this.params.grainSize.max,a=l.randomFloat(0,n)-n/2,i=l.clamp(t+a,0,this.buffer.duration),r=this.ctx.currentTime,s=this.ctx.createBufferSource();s.buffer=this.buffer,s.playbackRate.value=this.pitchShift,s.addEventListener("ended",(function(){e.grains.pop()}));var o,c,u=l.randomFloat(-1*this.pan,this.pan),h=!0;if(!h&&this.ctx.createStereoPanner?(o=this.ctx.createStereoPanner(),o.pan.value=u):(o=this.ctx.createPanner(),o.panningModel="equalpower",o.setPosition(u,0,1-Math.abs(u))),this.useEnvelope?(c=this.ctx.createGain(),s.connect(o),o.connect(c),c.connect(this.master)):(s.connect(o),o.connect(this.master)),s.start(r,i,this.grainSize),this.useEnvelope){c.gain.setValueAtTime(0,r);var f=r+this.envelope.attack,d=f+this.grainSize-this.envelope.release;c.gain.linearRampToValueAtTime(1,f),c.gain.linearRampToValueAtTime(0,d)}var v=l.map(i,0,this.buffer.duration,0,this.width);this.grains[0]={x:v},this.drawGrains()},clearCanvas:function(){this.canvasCtx.clearRect(0,0,this.width,this.height)},drawGrains:function(){this.clearCanvas(),this.canvasCtx.fillStyle="rgba(10, 10, 10, 0.4)",this.canvasCtx.beginPath();var e=5;this.canvasCtx.arc(this.x,this.height/2,e,0,2*Math.PI),this.canvasCtx.fill();for(var t=0;t<this.grains.length;t++){var n=this.grains[t].x;this.canvasCtx.fillStyle="rgba(197, 197, 197, 0.8)";var a=5,i=this.width/this.buffer.duration*this.grainSize,r=20,s=Math.max(a,i);this.canvasCtx.fillRect(n-i/2,this.height/2-r/2,s,r)}},updateInterval:function(){var e=this,t=l.map(this.overlap,this.params.overlap.min,this.params.overlap.max,this.grainSize,this.grainSize/2);this.origin&&(window.clearInterval(this.interval),this.interval=window.setInterval((function(){e.addGrain()}),1e3*t))}}},f=h,d=(n("5c0b"),n("2877")),v=Object(d["a"])(f,i,r,!1,null,null,null),p=v.exports,m=n("9483");Object(m["a"])("".concat("/DigiGranular/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var g=n("e37d"),b=n("dc21"),w=n("e594");a["a"].config.productionTip=!1,a["a"].use(g["a"]),b["a"]({dsn:"https://70738cb4636b44d0b589aebcecf9f839@sentry.io/1507320",integrations:[new w["a"]({Vue:a["a"],attachProps:!0})]}),new a["a"]({render:function(e){return e(p)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),i=n.n(a);i.a},"9c0c":function(e,t,n){}});
//# sourceMappingURL=app.0a1fa6c7.js.map